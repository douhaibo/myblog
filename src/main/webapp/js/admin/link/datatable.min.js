const TABLE_LINK_CONFIG={elem:"#datatable-link",height:470,url:"/myblog/link/getPageLinkList",page:true,toolbar:"#toolbar",cols:[[{type:"checkbox",fixed:"left"},{field:"id",title:"ID",fixed:"left"},{field:"title",title:"标题"},{field:"href",title:"地址"},{field:"type",title:"类型",templet:function(a){if(a.type===1){return"本地链接"}else{if(a.type===2){return"外链"}}}},{field:"createDateTime",title:"创建时间",sort:true,templet:function(a){return dateToStr(a.createDateTime)}},{field:"updateDateTime",title:"最后修改时间",width:170,sort:true,templet:function(a){return dateToStr(a.updateDateTime)}},{field:"mode",title:"模式",width:80,sort:true,templet:function(a){if(a.mode===0){return"已删除"}else{return"正常"}}},{fixed:"right",title:"操作",templet:"#opbar",width:180}]],response:{statusName:"status",statusCode:200,countName:"totalCount",msgName:"message"}};const $FORM_UPDATE_CONTAINER=$("#form-update-container");function deleteChecked(c,a){const b=a?"确认移除么？":"确认删除么？";layer.confirm(b,function(d){layer.close(d);$.ajax({url:"/myblog/link/deleteLinksByIdArray",data:{params:c,remove:a},dataType:"json",method:"GET",success:function(e){if(e.status===200&&e.request==="success"){layer.msg(e.message)}else{layer.msg(e.message,function(){})}},error:function(){ajaxErrorNormal()}})})}function showLayer(a){$FORM_UPDATE_CONTAINER.removeClass("layui-hide");layer.open({type:1,title:"修改链接信息",closeBtn:1,shadeClose:true,content:$FORM_UPDATE_CONTAINER,success:function(){$("#form-update-container  input[name='id']").val(a.id);$("#form-update-container  input[name='title']").val(a.title);$("#form-update-container  input[name='type']").val(a.type);$("#form-update-container  input[name='classNames']").val(a.classNames)},end:function(){$FORM_UPDATE_CONTAINER.addClass("layui-hide")}})}function deleteLinkById(c,a){const b=a?"真的移除么":"真的删除么";layer.confirm(b,function(d){layer.close(d);$.ajax({url:"/myblog/link/deleteLinkById",data:{id:c,remove:a},dataType:"json",method:"GET",success:function(e){if(e.status===200&&e.request==="success"){layer.msg(e.message)}else{layer.msg(e.message,function(){})}},error:function(){ajaxErrorNormal()}})})}function updateLink(a){let load;$.ajax({url:"/myblog/link/updateLink",method:"POST",data:JSON.stringify(a),dataType:"json",contentType:"application/json; charset=utf-8",beforeSend:function(){layui.use("layer",function(){const b=layui.layer;load=b.load(3,{time:10*1000})})},success:function(b){if(b.status===200&&b.request==="success"){layer.msg(b.message)}else{layer.msg(b.message,function(){})}},complete:function(){layui.use("layer",function(){const b=layui.layer;b.close(load)})},error:function(){ajaxErrorNormal()}})}layui.use("table",function(){const a=layui.table;a.render(TABLE_LINK_CONFIG);a.on("tool(datatable-link)",function(d){const c=d.data;const b=d.event;if(b==="update"){showLayer(c)}else{if(b==="delete"){if(c.mode===0){layer.msg("已经删除！");return}deleteLinkById(c.id,false)}else{if(b==="remove"){deleteLinkById(c.id,true)}}}});a.on("toolbar(datatable-link)",function(e){const c=e.event;const b=a.checkStatus(e.config.id);const f=[];const d=b.data;for(let i=0;d.length!==0&&i<d.length;i++){f.push(d[i].id)}if(c==="deleteChecked"){if(d.length===0){layer.msg("请选中元素后再进行操作");return}deleteChecked(f,false)}else{if(c==="removeChecked"){if(d.length===0){layer.msg("请选中元素后再进行操作");return}deleteChecked(f,true)}}})});layui.use("form",function(){const a=layui.form;a.on("submit(btn-update)",function(c){const b=c.field;updateLink(b);return false})});layui.use("form",function(){const a=layui.form;a.on("submit(btn-search)",function(c){const b=c.field;if(b.title===""&&b.id===""&&b.href===""){layui.use("table",function(){const d=layui.table;d.render(TABLE_LINK_CONFIG)})}else{layui.use("table",function(){const d=layui.table;d.reload("datatable-link",{url:"/myblog/link/searchLink",where:c.field,page:{curr:1}})})}return false})});layui.use("laydate",function(){const a=layui.laydate;a.render({elem:"#calendar",position:"static",mark:{"0-03-30":"生日","0-12-31":"跨年"}})});$(function(){(function(){const a=$(".link-friend-content");$.ajax({url:"/myblog/link/getFriendLinkList",method:"GET",dataType:"json",success:function(c){if(c.request==="success"&&c.status===200){const b=c.data;let result="";for(let i=0;i<b.length;i++){result+="<div class='link'><a href='"+b[i].href+"' target='_blank'><i class='fa fa-link'></i>"+b[i].title+"</a></div>"}a.html(result)}else{ajaxErrorNormal(c.message)}},error:function(){ajaxErrorNormal()}})})()});