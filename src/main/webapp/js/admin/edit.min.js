const EDITORMD_CONFIG={placeholder:"本编辑器支持Markdown编辑，左边编写，右边预览",height:1000,width:"90%",syncScrolling:"single",path:"lib/editor.md-master/lib/",theme:"default",previewTheme:"default",editorTheme:"neat",saveHTMLToTextarea:true,toolbarAutoFixed:true,emoji:false,taskList:true,tocm:true,flowChart:true,imageUpload:true,imageFormats:["jpg","jpeg","gif","png","bmp","webp"],imageUploadURL:"/myblog/editormdUploadImg",onload:function(a){},toolbarIcons:function(){return["bold","del","italic","quote","ucwords","uppercase","lowercase","|","h1","h2","h3","h4","h5","h6","|","list-ul","list-ol","hr","|","link","reference-link","image","table","datetime","|","watch","preview","clear","search","|","help","info"]}};function getImgUrlFromMarkDown(a){var b=/!\[.*?\]\((.*?)\)/im;var c=b.exec(a);if(c===null||c===undefined||c.length===0){return IMG_DEFAULT.src}else{return c[1]}}function validate(c){const e=c.title;const d=c.contentHtml;const a=c.contentMarkDown;const b=c.tag.id;if(e===""||e.length<4||e.length>30){layui.use("layer",function(){const f=layui.layer;f.alert("博客标题长度为4-30个字符！",{icon:2},function(g){f.close(g)})});return false}if(d===""||a===""){layui.use("layer",function(){const f=layui.layer;f.alert("博客内容不能为空！",{icon:2},function(g){f.close(g)})});return false}if(b===""){layui.use("layer",function(){const f=layui.layer;f.alert("请选择一个博客的标签！",{icon:2},function(g){f.close(g)})});return false}return true}function clean(a,b){a.clean();b.val("")}function sendAddBlogRequest(d,a,c){var b;$.ajax({url:"/myblog/addBlog",data:JSON.stringify(d),method:"POST",contentType:"application/json",dataType:"json",beforeSend:function(){layui.use("layer",function(){const e=layui.layer;b=e.load(3,{time:10*1000})})},success:function(e){clean(a,c);layer.msg(e.message,function(){layer.close(pop)})},complete:function(){layui.use("layer",function(){const e=layui.layer;e.close(b)})},error:function(){ajaxErrorNormal();clean(a,c);layer.close(pop)}})}$(function(){const b=editormd("blog-editormd",EDITORMD_CONFIG);var d=$("#release");var e=$("#btn-release");var a;var c=$("#title");$.ajax({url:"/myblog/getPageTagList",data:{pageParam:null},method:"GET",success:function(f){if(f.request==="success"&&f.status===200){}else{}},error:function(){}});e.click(function(){d.removeClass("layui-hide");a=layer.open({type:1,title:"发表博客",closeBtn:1,shadeClose:true,scrollbar:false,resize:false,content:d,offset:"200px",area:["500px","363px"],end:function(){d.addClass("layui-hide")}})});layui.use(["layer","form"],function(){var f=layui.layer;var g=layui.form;g.on("submit(submitBlog)",function(){var k=$("#title").val().trim();var j=b.getHTML().trim();var h=b.getMarkdown().trim();var i={title:k,contentHtml:j,contentMarkDown:h,mode:1,tag:{id:$("#blogTag").val()},coverImg:{src:getImgUrlFromMarkDown(h)}};if(validate(i)){sendAddBlogRequest(i,b,c)}return false})})});